{"name":"Docker-freeradius","tagline":"Freeradius docker container","body":"# Background\r\n\r\nSometimes for testing purposes network engineer needs to deploy small RADIUS server with SQL backend and some sort of web management. It can take from one hour or up to a whole day, just because since last time network engineer had done it, technology moved forward and this time one will account for new cobweb. So spending time on IT management should be minimal as much as possible. This article is about how to deploy Freeradius application with MySQL as backend and PMA as web management in short order. Short, I mean, are several minutes.\r\n\r\n# Action\r\n\r\nImagine you have a root access to Linux machine with access to the Internet. It does not matter it's virtual or physical. I would prefer to manage box with deadly simple orcherstration tool - Ansible. So you've better to have on the box.\r\n\r\n1. Installing Ansible.\r\n\r\n`apt-get -y update`\r\n`apt-get install -y python-yaml python-jinja2 python-httplib2 python-keyczar python-paramiko python-setuptools python-pkg-resources git python-pip`\r\n\r\n`git clone http://github.com/ansible/ansible.git /opt/ansible/ansible`\r\n`cd ansible`\r\n`git submodule update --init`\r\n\r\n`. ./hacking/env-setup`\r\n\r\n`echo '[local]\\nlocalhost\\n' > /etc/ansible/hosts`\r\n\r\n2. Installing Docker.\r\n\r\nNext step is to install fresh Docker ecosystem. If you do not already installed proceed with this recipe.\r\n\r\n`ansible-galaxy install angstwad.docker_ubuntu`\r\n\r\nCreate simple playbook with your favorite text editor.\r\n\r\n`cat /tmp/docker.yml`\r\n`- hosts:local`\r\n  `connection: local`\r\n  `roles:`\r\n    `- angstwad.docker_ubuntu`\r\n\r\nAnd just execute it.\r\n`ansible-playbook /tmp/docker.yml`\r\n\r\nNow you should have fresh and up-to-date Docker.\r\n\r\n3. Dockerize it.\r\n\r\nSo here where really magic begins. We create playbook with three simple tasks. These tasks actually will start MySQL, PMA and Freeradius. On the output you will get three running containers connected to each other and ready to serve.\r\n\r\nOnce again take your favorite editor and create following playbook:\r\n`cat fr_mysql_pma.yml `\r\n`---`\r\n`- hosts: local`\r\n  `connection: local`\r\n  `vars:`\r\n    `- mysql_root_pass: password123  `\r\n\r\n  `tasks:`\r\n    `- name: Start MySQL`\r\n      `docker: image=mysql name=freeradius-mysql volumes=\"/var/lib/mysql:volumes/mysql\" env=\"MYSQL_ROOT_PASSWORD={{ mysql_root_pass }}\"`\r\n\r\n    `- name: Start PMA`\r\n      `docker: image=corbinu/docker-phpmyadmin name=pma env=\"MYSQL_USERNAME=root\" links=freeradius-mysql:mysql ports=80:80`\r\n\r\n    `- name: Start Freeradius`\r\n      `docker: image=ramelito/docker-freeradius name=frv2 links=freeradius-mysql:mysql ports=1812:1812/udp,1813:1813/udp command=\"freeradius -f\"`\r\n\r\nRun it:\r\n`ansible-playbook fr_mysql_pma.yml`\r\n\r\nCheck it:\r\n`docker ps -a`\r\n`CONTAINER ID        IMAGE                               COMMAND                CREATED             STATUS              PORTS                                            NAMES`\r\n`fc250eae3986        ramelito/docker-freeradius:latest   \"./entrypoint.sh fre   7 minutes ago       Up 7 minutes        0.0.0.0:1812->1812/udp, 0.0.0.0:1813->1813/udp   frv2                `\r\n`5526ad668362        corbinu/docker-phpmyadmin:latest    \"/bin/sh -c phpmyadm   About an hour ago   Up About an hour    0.0.0.0:80->80/tcp                               pma                 `\r\n`bdaf6aeaf452        mysql:latest                        \"/entrypoint.sh mysq   About an hour ago   Up About an hour    3306/tcp                                         freeradius-mysql  `\r\n\r\n# Conclusion\r\n\r\n# References","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}