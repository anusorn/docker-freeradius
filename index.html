<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Docker-freeradius by ramelito</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Docker-freeradius</h1>
        <p>Freeradius docker container</p>

        <p class="view"><a href="https://github.com/ramelito/docker-freeradius">View the Project on GitHub <small>ramelito/docker-freeradius</small></a></p>


        <ul>
          <li><a href="https://github.com/ramelito/docker-freeradius/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/ramelito/docker-freeradius/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/ramelito/docker-freeradius">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="background" class="anchor" href="#background" aria-hidden="true"><span class="octicon octicon-link"></span></a>Background</h1>

<p>Sometimes for testing purposes network engineer needs to deploy small RADIUS server with SQL backend and some sort of web management. It can take from one hour or up to a whole day, just because since last time network engineer had done it, technology moved forward and this time one will account for new cobweb. So spending time on IT management should be minimal as much as possible. This article is about how to deploy Freeradius application with MySQL as backend and PMA as web management in short order. Short, I mean, are several minutes.</p>

<h1>
<a id="action" class="anchor" href="#action" aria-hidden="true"><span class="octicon octicon-link"></span></a>Action</h1>

<p>Imagine you have a root access to Linux machine with access to the Internet. It does not matter it's virtual or physical. I would prefer to manage box with deadly simple orcherstration tool - Ansible. So you've better to have on the box.</p>

<ol>
<li>Installing Ansible.</li>
</ol>

<p><code>apt-get -y update</code>
<code>apt-get install -y python-yaml python-jinja2 python-httplib2 python-keyczar python-paramiko python-setuptools python-pkg-resources git python-pip</code></p>

<p><code>git clone http://github.com/ansible/ansible.git /opt/ansible/ansible</code>
<code>cd ansible</code>
<code>git submodule update --init</code></p>

<p><code>. ./hacking/env-setup</code></p>

<p><code>echo '[local]\nlocalhost\n' &gt; /etc/ansible/hosts</code></p>

<ol>
<li>Installing Docker.</li>
</ol>

<p>Next step is to install fresh Docker ecosystem. If you do not already installed proceed with this recipe.</p>

<p><code>ansible-galaxy install angstwad.docker_ubuntu</code></p>

<p>Create simple playbook with your favorite text editor.</p>

<p><code>cat /tmp/docker.yml</code>
<code>- hosts:local</code>
  <code>connection: local</code>
  <code>roles:</code>
    <code>- angstwad.docker_ubuntu</code></p>

<p>And just execute it.
<code>ansible-playbook /tmp/docker.yml</code></p>

<p>Now you should have fresh and up-to-date Docker.</p>

<ol>
<li>Dockerize it.</li>
</ol>

<p>So here where really magic begins. We create playbook with three simple tasks. These tasks actually will start MySQL, PMA and Freeradius. On the output you will get three running containers connected to each other and ready to serve.</p>

<p>Once again take your favorite editor and create following playbook:
<code>cat fr_mysql_pma.yml</code>
<code>---</code>
<code>- hosts: local</code>
  <code>connection: local</code>
  <code>vars:</code>
    <code>- mysql_root_pass: password123  </code></p>

<p> <code>tasks:</code>
    <code>- name: Start MySQL</code>
      <code>docker: image=mysql name=freeradius-mysql volumes="/var/lib/mysql:volumes/mysql" env="MYSQL_ROOT_PASSWORD={{ mysql_root_pass }}"</code></p>

<p>   <code>- name: Start PMA</code>
      <code>docker: image=corbinu/docker-phpmyadmin name=pma env="MYSQL_USERNAME=root" links=freeradius-mysql:mysql ports=80:80</code></p>

<p>   <code>- name: Start Freeradius</code>
      <code>docker: image=ramelito/docker-freeradius name=frv2 links=freeradius-mysql:mysql ports=1812:1812/udp,1813:1813/udp command="freeradius -f"</code></p>

<p>Run it:
<code>ansible-playbook fr_mysql_pma.yml</code></p>

<p>Check it:
<code>docker ps -a</code>
<code>CONTAINER ID        IMAGE                               COMMAND                CREATED             STATUS              PORTS                                            NAMES</code>
<code>fc250eae3986        ramelito/docker-freeradius:latest   "./entrypoint.sh fre   7 minutes ago       Up 7 minutes        0.0.0.0:1812-&gt;1812/udp, 0.0.0.0:1813-&gt;1813/udp   frv2                </code>
<code>5526ad668362        corbinu/docker-phpmyadmin:latest    "/bin/sh -c phpmyadm   About an hour ago   Up About an hour    0.0.0.0:80-&gt;80/tcp                               pma                 </code>
<code>bdaf6aeaf452        mysql:latest                        "/entrypoint.sh mysq   About an hour ago   Up About an hour    3306/tcp                                         freeradius-mysql  </code></p>

<h1>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h1>

<h1>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h1>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/ramelito">ramelito</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>